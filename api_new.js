const _0x198c0a=_0x53d6;(function(_0x3460a5,_0x57d8fb){const _0x5704ed=_0x53d6,_0x1f3d91=_0x3460a5();while(!![]){try{const _0x357961=-parseInt(_0x5704ed(0x1f5))/0x1+parseInt(_0x5704ed(0x207))/0x2*(parseInt(_0x5704ed(0x1e7))/0x3)+-parseInt(_0x5704ed(0x23b))/0x4+parseInt(_0x5704ed(0x223))/0x5*(parseInt(_0x5704ed(0x241))/0x6)+parseInt(_0x5704ed(0x1e4))/0x7+-parseInt(_0x5704ed(0x242))/0x8+parseInt(_0x5704ed(0x1f9))/0x9;if(_0x357961===_0x57d8fb)break;else _0x1f3d91['push'](_0x1f3d91['shift']());}catch(_0x2e1c80){_0x1f3d91['push'](_0x1f3d91['shift']());}}}(_0x156b,0x602a7));function _0x53d6(_0x399cfd,_0xb297c1){const _0x156b69=_0x156b();return _0x53d6=function(_0x53d6c0,_0x2f55c2){_0x53d6c0=_0x53d6c0-0x1ca;let _0x520203=_0x156b69[_0x53d6c0];return _0x520203;},_0x53d6(_0x399cfd,_0xb297c1);}const ENV_CONFIG={'getEnvironment'(){const _0x252465=_0x53d6,_0x1d0312=window[_0x252465(0x1eb)][_0x252465(0x21c)];if(_0x1d0312===_0x252465(0x1cb)||_0x1d0312[_0x252465(0x1d3)](_0x252465(0x1d0)))return _0x252465(0x228);return _0x252465(0x1fb);},'proxyEndpoints':{'development':_0x198c0a(0x235),'production':'http://212.64.57.87:16001/proxy'},'getProxyEndpoint'(){const _0x43b745=_0x198c0a,_0x578ada=this[_0x43b745(0x1f7)]();return this[_0x43b745(0x1d8)][_0x578ada];}},API_CONFIG={'UNIFUNS':{'endpointAI':_0x198c0a(0x1e3),'endpointCN':_0x198c0a(0x21a),'endpoint':'https://api.302.ai/unifuncs/api/web-reader/read','region':'ai','apiKey':'','useProxy':!![],'proxyEndpoint':ENV_CONFIG[_0x198c0a(0x244)]()},'GEMINI':{'endpoint':_0x198c0a(0x1e2),'apiKey':_0x198c0a(0x1d4),'useProxy':![]},'NANO_BANANA':{'endpoint':_0x198c0a(0x1cd),'apiKey':_0x198c0a(0x1fa),'useProxy':![]}};async function fetchNewsContent(_0x5c2f28){const _0x1f5671=_0x198c0a;try{console[_0x1f5671(0x222)](_0x1f5671(0x238),_0x5c2f28);const _0x2ef5a6=!!API_CONFIG[_0x1f5671(0x220)][_0x1f5671(0x1cc)],_0x12e5a2=(API_CONFIG[_0x1f5671(0x220)][_0x1f5671(0x1e8)]||'')['trim']();if(!_0x2ef5a6){if(!_0x12e5a2)throw new Error(_0x1f5671(0x234));!_0x12e5a2['startsWith'](_0x1f5671(0x1fd))&&console['warn']('提示：当前API密钥似乎不是以\x20\x22sk-\x22\x20开头，可能不适用于该接口。');}const _0x807df4=new Headers();!_0x2ef5a6&&_0x807df4[_0x1f5671(0x200)](_0x1f5671(0x20c),'Bearer\x20'+_0x12e5a2);_0x807df4[_0x1f5671(0x200)](_0x1f5671(0x1f8),_0x1f5671(0x21f)),_0x807df4[_0x1f5671(0x200)](_0x1f5671(0x21d),_0x1f5671(0x21f));const _0x1f1348=JSON[_0x1f5671(0x1e9)]({'url':_0x5c2f28,'format':_0x1f5671(0x219),'liteMode':!![],'includeImages':![]}),_0x3ac355={'method':_0x1f5671(0x1d6),'headers':_0x807df4,'body':_0x1f1348,'redirect':_0x1f5671(0x202)};console[_0x1f5671(0x222)]('发送请求到Unifuns\x20API...'),API_CONFIG[_0x1f5671(0x220)]['endpoint']=API_CONFIG[_0x1f5671(0x220)][_0x1f5671(0x230)],API_CONFIG[_0x1f5671(0x220)][_0x1f5671(0x1cc)]=!![];const _0xe43302=new URLSearchParams({'url':_0x5c2f28})[_0x1f5671(0x1e6)](),_0x1b107b=API_CONFIG[_0x1f5671(0x220)][_0x1f5671(0x209)]+'?'+_0xe43302;console['log']('请求URL:',_0x1b107b),console[_0x1f5671(0x222)](_0x1f5671(0x1e0),_0x1f1348);let _0x30b8ca=await fetch(_0x1b107b,_0x3ac355);if(!_0x30b8ca['ok']){let _0xbf642e='';try{_0xbf642e=await _0x30b8ca['text']();}catch{}console['error'](_0x1f5671(0x1da),_0xbf642e);throw new Error('爬取失败:\x20'+_0x30b8ca['status']+'\x20'+_0x30b8ca[_0x1f5671(0x1f3)]);}const _0xb56c3=await _0x30b8ca['text']();console[_0x1f5671(0x222)]('Unifuns\x20API\x20返回（长度）:',_0xb56c3?_0xb56c3[_0x1f5671(0x205)]:0x0);let _0x56f3b5;try{return _0x56f3b5=JSON['parse'](_0xb56c3),console[_0x1f5671(0x222)](_0x1f5671(0x225),_0x56f3b5),_0x56f3b5[_0x1f5671(0x227)]||_0x56f3b5[_0x1f5671(0x1d7)]||_0x56f3b5;}catch{return console[_0x1f5671(0x222)](_0x1f5671(0x1d9)),_0xb56c3;}}catch(_0x452548){console[_0x1f5671(0x216)](_0x1f5671(0x218),_0x452548);throw new Error('无法获取新闻内容:\x20'+_0x452548['message']);}}async function extractNewsContent(_0x37c363){const _0x37f0f5=_0x198c0a;try{console['log'](_0x37f0f5(0x1ea));const _0x3ab9d4=PROMPTS[_0x37f0f5(0x201)]['replace'](_0x37f0f5(0x22b),_0x37c363),_0x34c6d6=new Headers();_0x34c6d6[_0x37f0f5(0x200)]('Accept',_0x37f0f5(0x21f)),_0x34c6d6[_0x37f0f5(0x200)](_0x37f0f5(0x1f8),_0x37f0f5(0x21f));!API_CONFIG[_0x37f0f5(0x20b)][_0x37f0f5(0x1cc)]&&API_CONFIG[_0x37f0f5(0x20b)][_0x37f0f5(0x1e8)]&&_0x34c6d6[_0x37f0f5(0x200)]('Authorization',_0x37f0f5(0x22f)+API_CONFIG[_0x37f0f5(0x20b)]['apiKey']);const _0x19efe6=JSON[_0x37f0f5(0x1e9)]({'model':_0x37f0f5(0x22c),'messages':[{'role':_0x37f0f5(0x204),'content':_0x3ab9d4}]}),_0x2aae55={'method':'POST','headers':_0x34c6d6,'body':_0x19efe6,'redirect':_0x37f0f5(0x202)},_0x181d1a=API_CONFIG['GEMINI'][_0x37f0f5(0x1ec)]||'https://api.302.ai/v1/chat/completions';console[_0x37f0f5(0x222)](_0x37f0f5(0x21e),_0x181d1a),console[_0x37f0f5(0x222)](_0x37f0f5(0x20d),API_CONFIG[_0x37f0f5(0x20b)][_0x37f0f5(0x1cc)]);const _0x361bfb=await fetch(_0x181d1a,_0x2aae55),_0x278177=await _0x361bfb[_0x37f0f5(0x23f)]();let _0x2ee01f={'sections':[]};const _0x47cfea=_0x50ea88=>{const _0x16c665=_0x37f0f5;if(typeof _0x50ea88!==_0x16c665(0x221))return null;const _0x30979e=_0x50ea88[_0x16c665(0x1db)](),_0x146269=_0x30979e[_0x16c665(0x20e)](/```(?:json)?\n([\s\S]*?)```/i),_0x29de72=_0x146269?_0x146269[0x1]['trim']():_0x30979e;try{return JSON['parse'](_0x29de72);}catch{}const _0x1106a6=_0x29de72[_0x16c665(0x214)]('{'),_0x4fcc10=_0x29de72[_0x16c665(0x206)]('}');if(_0x1106a6!==-0x1&&_0x4fcc10!==-0x1&&_0x4fcc10>_0x1106a6){const _0x45ef4e=_0x29de72['slice'](_0x1106a6,_0x4fcc10+0x1);try{return JSON[_0x16c665(0x212)](_0x45ef4e);}catch{}}return null;};try{const _0x5857e8=JSON[_0x37f0f5(0x212)](_0x278177);console[_0x37f0f5(0x222)](_0x37f0f5(0x243)),console['log'](_0x5857e8);let _0x15dab1=_0x5857e8&&_0x5857e8['choices']&&_0x5857e8[_0x37f0f5(0x1f0)][0x0]&&_0x5857e8['choices'][0x0]['message']&&_0x5857e8[_0x37f0f5(0x1f0)][0x0][_0x37f0f5(0x22a)][_0x37f0f5(0x1d7)];Array['isArray'](_0x15dab1)&&(_0x15dab1=_0x15dab1[_0x37f0f5(0x1df)](_0xd6a642=>typeof _0xd6a642==='string'?_0xd6a642:_0xd6a642&&(_0xd6a642[_0x37f0f5(0x23f)]||_0xd6a642['content']||''))[_0x37f0f5(0x208)]('\x0a'));if(typeof _0x15dab1===_0x37f0f5(0x221)){const _0x1b6999=_0x47cfea(_0x15dab1);_0x1b6999&&typeof _0x1b6999==='object'?(console[_0x37f0f5(0x222)]('===\x20Gemini\x20内层\x20JSON（提炼结果）==='),console[_0x37f0f5(0x222)](_0x1b6999),_0x2ee01f=_0x1b6999):(console[_0x37f0f5(0x222)](_0x37f0f5(0x233)),console[_0x37f0f5(0x222)](_0x15dab1));}else _0x15dab1&&typeof _0x15dab1===_0x37f0f5(0x211)&&_0x15dab1[_0x37f0f5(0x23e)]&&(_0x2ee01f=_0x15dab1);}catch{console['warn'](_0x37f0f5(0x213));}return console['log'](_0x37f0f5(0x1ef),Array['isArray'](_0x2ee01f['sections'])?_0x2ee01f[_0x37f0f5(0x23e)][_0x37f0f5(0x205)]:0x0),_0x2ee01f;}catch(_0x4a1df6){return console[_0x37f0f5(0x216)](_0x37f0f5(0x1e1),_0x4a1df6),{};}}function buildFinalImagePrompt(_0x5d4450){const _0x259072=_0x198c0a,_0x18ba2b=_0x259072(0x237);return _0x5d4450+'\x20'+_0x18ba2b;}async function callNanoBanana(_0x2bf95b,_0x7bce2f=0x0){const _0x576c88=_0x198c0a;try{const _0x685449=API_CONFIG['NANO_BANANA'][_0x576c88(0x1ec)],_0x560cb1=(API_CONFIG[_0x576c88(0x203)][_0x576c88(0x1e8)]||'')[_0x576c88(0x1db)]();if(!API_CONFIG[_0x576c88(0x203)][_0x576c88(0x1cc)]&&(!_0x685449||!_0x560cb1))return console[_0x576c88(0x1d5)]('[NanoBanana]\x20endpoint\x20或\x20apiKey\x20未配置，跳过调用'),{'title':'','imageUrl':''};const _0xb12971=buildFinalImagePrompt(_0x2bf95b),_0x4b3aa1=new Headers();_0x4b3aa1['append'](_0x576c88(0x1f8),_0x576c88(0x21f));!API_CONFIG['NANO_BANANA'][_0x576c88(0x1cc)]&&_0x560cb1&&_0x4b3aa1[_0x576c88(0x200)](_0x576c88(0x20c),_0x576c88(0x22f)+_0x560cb1);const _0x47198b=JSON[_0x576c88(0x1e9)]({'contents':[{'parts':[{'text':_0xb12971}]}],'generationConfig':{'responseModalities':[_0x576c88(0x1f6),'IMAGE']}}),_0x2f06e0=new AbortController(),_0x24bb09=setTimeout(()=>_0x2f06e0['abort'](),0xea60),_0x194ee6={'method':_0x576c88(0x1d6),'headers':_0x4b3aa1,'body':_0x47198b,'redirect':_0x576c88(0x202),'signal':_0x2f06e0['signal']};console['log']('[NanoBanana]\x20请求\x20endpoint:',_0x685449,_0x7bce2f>0x0?'(重试\x20'+_0x7bce2f+')':''),console[_0x576c88(0x222)](_0x576c88(0x1dd),API_CONFIG[_0x576c88(0x203)][_0x576c88(0x1cc)]),console[_0x576c88(0x222)](_0x576c88(0x1fe),_0xb12971[_0x576c88(0x236)](0x0,0xb4)+(_0xb12971[_0x576c88(0x205)]>0xb4?'…':''));const _0x2b359d=await fetch(_0x685449,_0x194ee6);clearTimeout(_0x24bb09);if(!_0x2b359d['ok'])throw new Error('HTTP\x20'+_0x2b359d['status']+':\x20'+_0x2b359d[_0x576c88(0x1f3)]);const _0x6bf50e=await _0x2b359d[_0x576c88(0x23f)]();let _0x17d22f='';try{const _0x3f9e1c=JSON['parse'](_0x6bf50e);_0x17d22f=_0x3f9e1c[_0x576c88(0x22d)]||_0x3f9e1c['url']||_0x3f9e1c[_0x576c88(0x227)]&&_0x3f9e1c[_0x576c88(0x227)][0x0]&&_0x3f9e1c[_0x576c88(0x227)][0x0][_0x576c88(0x210)]||'';if(!_0x17d22f&&Array[_0x576c88(0x215)](_0x3f9e1c[_0x576c88(0x1f2)])&&_0x3f9e1c[_0x576c88(0x1f2)][0x0]&&_0x3f9e1c[_0x576c88(0x1f2)][0x0][_0x576c88(0x1d7)]&&Array['isArray'](_0x3f9e1c['candidates'][0x0][_0x576c88(0x1d7)]['parts'])){const _0x8f9ac5=_0x3f9e1c[_0x576c88(0x1f2)][0x0]['content']['parts'],_0x32f86e=_0x8f9ac5[_0x576c88(0x1d1)](_0x38fc1a=>typeof _0x38fc1a[_0x576c88(0x210)]==='string'&&_0x38fc1a[_0x576c88(0x210)]);if(_0x32f86e)_0x17d22f=_0x32f86e['url'];}}catch{console[_0x576c88(0x1d5)](_0x576c88(0x1ff));}return console[_0x576c88(0x222)](_0x576c88(0x20a),_0x17d22f),{'title':'','imageUrl':_0x17d22f||''};}catch(_0x4de8e8){console[_0x576c88(0x216)]('[NanoBanana]\x20调用失败:',_0x4de8e8['message']||_0x4de8e8);if(_0x7bce2f<0x1&&(_0x4de8e8[_0x576c88(0x23d)]==='AbortError'||_0x4de8e8[_0x576c88(0x22a)][_0x576c88(0x1d3)]('Failed\x20to\x20fetch')||_0x4de8e8['message']['includes'](_0x576c88(0x224))))return console[_0x576c88(0x222)](_0x576c88(0x1ed)),await new Promise(_0x5f4d85=>setTimeout(_0x5f4d85,0x5dc)),callNanoBanana(_0x2bf95b,_0x7bce2f+0x1);return{'title':'','imageUrl':''};}}async function generateImages(_0x55d212){const _0x17acae=_0x198c0a;try{console[_0x17acae(0x222)](_0x17acae(0x1fc));if(!Array[_0x17acae(0x215)](_0x55d212)||_0x55d212[_0x17acae(0x205)]===0x0)return console[_0x17acae(0x1d5)](_0x17acae(0x1e5)),_0x55d212||[];const _0x661e9c=_0x55d212['length'],_0x2da312=[];for(let _0x3250ed=0x0;_0x3250ed<_0x55d212['length'];_0x3250ed++){const _0x53194a=_0x55d212[_0x3250ed],_0x4f139d=_0x53194a&&_0x53194a[_0x17acae(0x22e)];if(!_0x4f139d){console[_0x17acae(0x1d5)]('[NanoBanana]\x20第'+(_0x3250ed+0x1)+_0x17acae(0x1f4)),_0x2da312[_0x17acae(0x1dc)](null);continue;}const _0x521ce5=_0x3250ed+0x1;typeof updateActivityDetails==='function'&&updateActivityDetails(_0x17acae(0x1cf)+_0x521ce5+'/'+_0x661e9c,'为模块\x22'+(_0x53194a['sectionTitle']||_0x53194a['title']||'未知模块')+_0x17acae(0x20f));try{const {imageUrl:_0x224847}=await callNanoBanana(_0x4f139d);console[_0x17acae(0x222)](_0x17acae(0x23c)+(_0x3250ed+0x1)+'个模块',_0x17acae(0x226),_0x53194a[_0x17acae(0x23a)]||'','imageUrl=',_0x224847),_0x2da312[_0x17acae(0x1dc)](_0x224847);}catch(_0x396191){console['error'](_0x17acae(0x23c)+(_0x3250ed+0x1)+_0x17acae(0x1f1),_0x396191),_0x2da312[_0x17acae(0x1dc)](null);}}return console[_0x17acae(0x222)](_0x17acae(0x1ca),_0x2da312),_0x55d212[_0x17acae(0x1d2)]((_0x5b3a5c,_0x5b0d09)=>{const _0x4a761e=_0x17acae;_0x5b3a5c[_0x4a761e(0x22d)]=_0x2da312[_0x5b0d09]||'';}),_0x55d212;}catch(_0x11d12f){return console['error'](_0x17acae(0x229),_0x11d12f),_0x55d212||[];}}(function(){const _0x31f9ea=_0x198c0a,_0xff9d05=ENV_CONFIG[_0x31f9ea(0x1f7)](),_0x18f33c=API_CONFIG?.[_0x31f9ea(0x220)]?.[_0x31f9ea(0x209)];console[_0x31f9ea(0x222)](_0x31f9ea(0x239)+_0xff9d05),console[_0x31f9ea(0x222)](_0x31f9ea(0x1de)+_0x18f33c),console[_0x31f9ea(0x222)](_0x31f9ea(0x21b)+API_CONFIG[_0x31f9ea(0x20b)][_0x31f9ea(0x1ec)]),console[_0x31f9ea(0x222)](_0x31f9ea(0x217)+API_CONFIG['NANO_BANANA'][_0x31f9ea(0x1ec)]);}());function _0x156b(){const _0x34d680=['[Gemini]\x20请求\x20endpoint:','application/json','UNIFUNS','string','log','45NrJHzl','ERR_CONNECTION','解析后的JSON数据:','title=','data','production','生成插图失败:','message','{NEWS_CONTENT}','gemini-2.5-flash','imageUrl','imagePrompt','Bearer\x20','endpointAI','extractNewsContent','fetchNewsContent','===\x20Gemini\x20内层文本（未能解析为\x20JSON）===','未配置\x20Unifuns\x20API\x20密钥','http://212.64.57.87:16001/proxy','slice','\x20Additional\x20requirements:\x20background\x20color\x20must\x20be\x20#f5f2e8;\x20hand-drawn\x20colored\x20pencil\x20style\x20with\x20rich\x20visual\x20elements;\x20include\x20multiple\x20charts,\x20graphs,\x20or\x20infographics;\x20add\x20various\x20financial\x20icons\x20like\x20trending\x20arrows,\x20currency\x20symbols,\x20building\x20silhouettes,\x20and\x20market\x20indicators;\x20use\x20vibrant\x20blue,\x20green,\x20gold,\x20and\x20red\x20highlights;\x20include\x20small\x20English\x20annotations\x20and\x20data\x20labels\x20from\x20the\x20article;\x20add\x20decorative\x20elements\x20like\x20grid\x20lines,\x20geometric\x20shapes,\x20and\x20subtle\x20patterns;\x20create\x20a\x20visually\x20engaging\x20but\x20professional\x20financial\x20illustration;\x20no\x20watermarks;\x20no\x20real\x20faces;\x20balanced\x20composition\x20with\x20good\x20visual\x20hierarchy.','开始爬取新闻内容:','[环境]\x20当前环境:\x20','sectionTitle','2873056nERMQZ','[NanoBanana]\x20第','name','sections','text','undefined','131598adcmln','5955280mmwPtX','===\x20Gemini\x20JSON\x20解析成功\x20===','getProxyEndpoint','[NanoBanana]\x20生成结果汇总:','siyuanjia.github.io','useProxy','https://api.302.ai/google/v1/models/gemini-2.5-flash-image-preview?response_format','callNanoBanana','正在生成插图\x20','brief-prod','find','forEach','includes','sk-aE0CzP46qaMdvt1u1gcNZXBr0oDUWrzLaEJsjje8HBxnLJGA','warn','POST','content','proxyEndpoints','响应不是JSON格式，直接返回文本内容','Unifuns错误响应体:','trim','push','[NanoBanana]\x20使用代理:','[环境]\x20代理端点:\x20','map','请求体:','提炼新闻内容失败:','https://api.302.ai/v1/chat/completions','https://api.302.ai/unifuncs/api/web-reader/read','3510059VhlfhP','[NanoBanana]\x20sections\x20为空或非数组，跳过生成','toString','9GjuTrp','apiKey','stringify','开始提炼新闻内容','location','endpoint','[NanoBanana]\x20超时/网络错误，准备重试一次...','generateImages','[Gemini]\x20提炼结果用于生成插图的\x20sections\x20数量\x20=','choices','个模块插图生成失败:','candidates','statusText','个缺少\x20imagePrompt，跳过','229795UdEsVU','TEXT','getEnvironment','Content-Type','7342677pFUVIy','sk-l1k1WmtcTJOugQWCvkHFJUacCxdxIYyXwqss7yuGZLUHvwL3','development','开始生成插图（仅控制台输出，不改渲染）','sk-','[NanoBanana]\x20请求体\x20prompt\x20预览:','[NanoBanana]\x20返回非\x20JSON\x20或解析失败，已原样打印','append','CONTENT_EXTRACTION','follow','NANO_BANANA','user','length','lastIndexOf','381118RCjjBm','join','proxyEndpoint','[NanoBanana]\x20解析出的\x20imageUrl:','GEMINI','Authorization','[Gemini]\x20使用代理:','match','\x22生成配套图表...','url','object','parse','[Gemini]\x20返回不是\x20JSON，已原样打印','indexOf','isArray','error','[环境]\x20NanoBanana直连:\x20','爬取新闻内容失败:','markdown','https://api.302ai.cn/unifuncs/api/web-reader/read','[环境]\x20Gemini直连:\x20','hostname','Accept'];_0x156b=function(){return _0x34d680;};return _0x156b();}typeof window!==_0x198c0a(0x240)&&(window['ENV_CONFIG']=ENV_CONFIG,window['API_CONFIG']=API_CONFIG,window[_0x198c0a(0x232)]=fetchNewsContent,window[_0x198c0a(0x231)]=extractNewsContent,window[_0x198c0a(0x1ce)]=callNanoBanana,window[_0x198c0a(0x1ee)]=generateImages);